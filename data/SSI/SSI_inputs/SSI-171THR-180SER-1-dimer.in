import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -1.375557463776   -0.294431330349    1.891027322672
 O   -1.352557463776    0.396568669651    0.643027322672
 H   -0.454557463776    0.348568669651    0.277027322672
 H   -0.803557463776    0.285568669651    2.617027322672
 H   -2.411637463776   -0.411921330349    2.241367322672
 H   -0.898707463776   -1.278201330349    1.769307322672
 C    1.288442536224   -0.407431330349   -1.879972677328
 O    1.333442536224    0.305568669651   -0.658972677328
 H    2.122442536224    0.029568669651   -0.172972677328
 H    0.455442536224   -0.019431330349   -2.467972677328
 H    1.112442536224   -1.467431330349   -1.690972677328
 H    2.218762536224   -0.273191330349   -2.451372677328
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-171THR-180SER-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-171THR-180SER-1-dimer.npy', np.array(charges))