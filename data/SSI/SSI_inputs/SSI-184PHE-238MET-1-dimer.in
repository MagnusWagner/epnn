import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    3.493627638937   -0.392944492900    2.595447154846
 C    0.901627638937    0.271055507100   -0.115552845154
 C    1.745627638937    0.467055507100    0.980447154846
 C    0.845627638937   -0.942944492900   -0.762552845154
 C    2.519627638937   -0.597944492900    1.458447154846
 C    1.547627638937   -2.023944492900   -0.262552845154
 C    2.417627638937   -1.831944492900    0.841447154846
 H    0.329627638937    1.104055507100   -0.496552845154
 H    1.791627638937    1.425055507100    1.461447154846
 H    0.211627638937   -1.062944492900   -1.630552845154
 H    1.486627638937   -2.973944492900   -0.762552845154
 H    3.835627638937    0.643055507100    2.567447154846
 H    4.364627638937   -1.029944492900    2.446447154846
 H    3.012627638937   -2.660944492900    1.197447154846
 H    3.076397638937   -0.598624492900    3.592247154846
 C   -2.338372361063    1.604055507100    0.221447154846
 C   -3.929372361063    1.492055507100   -1.999552845154
 S   -2.664372361063    0.564055507100   -1.215552845154
 H   -3.232372361063    1.698055507100    0.836447154846
 H   -1.554372361063    1.149055507100    0.825447154846
 H   -2.013372361063    2.591055507100   -0.108552845154
 H   -4.125372361063    1.064055507100   -2.981552845154
 H   -3.553372361063    2.503055507100   -2.148552845154
 H   -4.878442361063    1.538765507100   -1.445402845154
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-184PHE-238MET-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-184PHE-238MET-1-dimer.npy', np.array(charges))