import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -0.683127591765   -3.359027605626    1.019096108435
 C    0.269872408235    0.152972394374    0.071096108435
 C    0.339872408235   -1.191027605626    0.342096108435
 C   -0.924127591765    0.837972394374    0.158096108435
 C   -0.765127591765   -1.891027605626    0.757096108435
 C   -2.061127591765    0.143972394374    0.540096108435
 C   -1.968127591765   -1.237027605626    0.844096108435
 H    1.168872408235    0.651972394374   -0.240903891565
 H    1.288872408235   -1.695027605626    0.229096108435
 H   -0.975127591765    1.893972394374   -0.070903891565
 H   -3.013127591765    0.654972394374    0.608096108435
 H   -0.509127591765   -3.863027605626    0.070096108435
 H   -1.657127591765   -3.692027605626    1.364096108435
 H   -2.860127591765   -1.773027605626    1.139096108435
 H    0.081592408235   -3.663345605626    1.748886108435
 C    2.528872408235    2.909972394374   -0.888903891565
 C    2.536872408235    3.079972394374   -2.417903891565
 H    2.786872408235    3.838972394374   -0.383903891565
 H    1.518872408235    2.671972394374   -0.568903891565
 H    3.221872408235    2.128972394374   -0.597903891565
 H    1.813872408235    3.860972394374   -2.658903891565
 H    3.537412408235    3.404608594374   -2.739663891565
 H    2.242522408235    2.167475194374   -2.957073891565
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-116PHE-130VAL-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-116PHE-130VAL-1-dimer.npy', np.array(charges))