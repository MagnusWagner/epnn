import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -1.335482524440    1.481388604497   -2.644157251924
 O   -0.729482524440    1.694388604497   -1.361157251924
 H   -0.975482524440    2.587388604497   -1.077157251924
 H   -1.183482524440    2.373388604497   -3.253157251924
 H   -0.852102524440    0.630028604497   -3.145687251924
 H   -2.418772524440    1.311248604497   -2.557297251924
 C    1.207517475560   -1.409611395503    2.265842748076
 C    0.535517475560   -0.911611395503    1.000842748076
 O    0.403517475560   -1.630611395503    0.011842748076
 N    0.119517475560    0.355388604497    1.025842748076
 H   -0.244482524440    0.750388604497    0.163842748076
 H    0.267517475560    0.929388604497    1.840842748076
 H    0.581517475560   -1.099611395503    3.103842748076
 H    2.179517475560   -0.927611395503    2.382842748076
 H    1.305797475560   -2.504931395503    2.290772748076
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-046THR-069ASN-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-046THR-069ASN-1-dimer.npy', np.array(charges))