import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C   -1.943609539478    1.400985827835   -1.786486425364
 O   -1.769609539478    0.150985827835   -1.099486425364
 H   -0.810609539478    0.011985827835   -0.904486425364
 H   -1.432609539478    1.363985827835   -2.749486425364
 H   -1.523609539478    2.211985827835   -1.194486425364
 H   -3.023279539478    1.553051827835   -1.932036425364
 C   -0.008609539478   -0.347014172165    1.863513574636
 C    1.049390460522   -0.419014172165    0.734513574636
 O    0.676390460522   -0.431014172165   -0.442486425364
 O    2.254390460522   -0.460014172165    0.959513574636
 H   -0.672609539478   -1.211014172165    1.790513574636
 H   -0.607609539478    0.545985827835    1.684513574636
 H    0.391520460522   -0.291299172165    2.886643574636
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-133SER-161GLU-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-133SER-161GLU-1-dimer.npy', np.array(charges))