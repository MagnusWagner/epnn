import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -0.422296982799   -0.990625862235    1.238255969950
 C   -1.292296982799   -2.138625862235    1.692255969950
 H   -0.932296982799   -0.399625862235    0.477255969950
 H   -0.232296982799   -0.331625862235    2.088255969950
 H    0.538703017201   -1.348625862235    0.864255969950
 H   -2.245296982799   -1.708625862235    1.985255969950
 H   -1.471506982799   -2.831797562235    0.857151969950
 H   -0.880026982799   -2.616207562235    2.593339969950
 C    0.987703017201    1.838374137765   -0.746744030050
 C    0.735703017201    1.277374137765   -2.189744030050
 H    2.052703017201    1.816374137765   -0.507744030050
 H    0.636703017201    2.869374137765   -0.690744030050
 H    0.444703017201    1.256374137765   -0.009744030050
 H   -0.325296982799    1.382374137765   -2.413744030050
 H    0.999953017201    0.211167137765   -2.247836030050
 H    1.309033017201    1.861628137765   -2.924547030050
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-007VAL-040THR-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-007VAL-040THR-1-dimer.npy', np.array(charges))