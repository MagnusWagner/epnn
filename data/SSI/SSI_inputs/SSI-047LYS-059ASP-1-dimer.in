import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -0.248301004604   -0.349431616902   -3.157865974464
 N   -1.091301004604   -0.799431616902   -2.012865974464
 H   -0.581301004604   -0.728431616902   -1.124865974464
 H   -1.919301004604   -0.225431616902   -1.922865974464
 H   -1.391301004604   -1.759431616902   -2.121865974464
 H    0.066698995396    0.689568383098   -3.013865974464
 H   -0.826301004604   -0.403431616902   -4.086865974464
 H    0.643148995396   -0.986601616902   -3.254495974464
 C    1.150698995396    0.072568383098    2.566134025536
 C    0.335698995396    0.320568383098    1.322134025536
 O    0.121698995396   -0.595431616902    0.491134025536
 O   -0.104301004604    1.473568383098    1.160134025536
 H    1.075698995396    0.910568383098    3.258134025536
 H    2.194698995396    0.017568383098    2.253134025536
 H    0.882948995396   -0.863851616902    3.077428025536
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-047LYS-059ASP-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-047LYS-059ASP-1-dimer.npy', np.array(charges))