import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -0.240728763523   -2.193170147441   -0.929516786268
 O   -0.187728763523   -1.532170147441    0.332483213732
 H   -0.030728763523   -0.580170147441    0.199483213732
 H    0.751271236477   -2.550170147441   -1.207516786268
 H   -0.941868763523   -3.028700147441   -0.787096786268
 H   -0.627218763523   -1.507020147441   -1.697516786268
 C    0.142271236477    2.473829852559   -0.058516786268
 O    0.226271236477    1.207829852559    0.609483213732
 H    1.106271236477    1.135829852559    1.025483213732
 H    0.435271236477    3.275829852559    0.617483213732
 H    0.770611236477    2.453719852559   -0.961166786268
 H   -0.902988763523    2.606429852559   -0.374496786268
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-025THR-045THR-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-025THR-045THR-1-dimer.npy', np.array(charges))