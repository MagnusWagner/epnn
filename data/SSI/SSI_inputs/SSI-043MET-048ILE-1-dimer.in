import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -0.653672621464    0.362076902634   -0.676411365020
 C   -2.135672621464    0.343076902634   -1.030411365020
 C   -0.683672621464    3.046076902634    0.044588634980
 S    0.167327378536    1.908076902634   -1.091411365020
 H   -0.586672621464    0.269076902634    0.405588634980
 H   -0.112672621464   -0.467923097366   -1.098411365020
 H   -2.249672621464    0.396076902634   -2.113411365020
 H   -2.615672621464    1.219076902634   -0.597411365020
 H   -0.657672621464    2.649076902634    1.059588634980
 H   -0.177672621464    4.012076902634    0.028588634980
 H   -1.717672621464    3.192076902634   -0.266411365020
 H   -2.654982621464   -0.544493097366   -0.639851365020
 C    0.541327378536   -2.477923097366    1.188588634980
 C    0.942327378536   -2.988923097366    2.575588634980
 C    1.692327378536   -2.482923097366    0.184588634980
 H   -0.284672621464   -3.064923097366    0.797588634980
 H    0.216327378536   -1.447923097366    1.271588634980
 H    1.794327378536   -2.402923097366    2.922588634980
 H    2.055327378536   -3.496923097366    0.018588634980
 H    1.337327378536   -2.097923097366   -0.768411365020
 H    2.509327378536   -1.855923097366    0.544588634980
 H    0.118267378536   -2.855713097366    3.291950634980
 H    1.254947378536   -4.043023097366    2.541655634980
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-043MET-048ILE-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-043MET-048ILE-1-dimer.npy', np.array(charges))