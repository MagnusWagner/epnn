import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C   -2.200545362833   -0.254332600337   -1.697006113408
 O   -2.282545362833    0.071667399663   -0.337006113408
 H   -1.452545362833   -0.204332600337    0.098993886592
 H   -1.650545362833   -1.185332600337   -1.831006113408
 H   -1.696545362833    0.547667399663   -2.239006113408
 H   -3.232255362833   -0.369048600337   -2.060886113408
 C    1.125454637167    1.335667399663   -0.124006113408
 C    1.206454637167   -0.007332600337    0.587993886592
 O    0.166454637167   -0.594332600337    0.937993886592
 O    2.315454637167   -0.520332600337    0.765993886592
 H    0.631454637167    1.165667399663   -1.083006113408
 H    2.123454637167    1.725667399663   -0.337006113408
 H    0.548804637167    2.084883399663    0.438263886592
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-098SER-164ASP-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-098SER-164ASP-1-dimer.npy', np.array(charges))