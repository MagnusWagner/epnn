import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -0.407735210859    1.623780791593   -0.723248540587
 C    1.089264789141    1.634780791593   -1.052248540587
 H   -0.929735210859    0.884780791593   -1.327248540587
 H   -0.546735210859    1.383780791593    0.329751459413
 H   -0.844735210859    2.607780791593   -0.894248540587
 H    1.493264789141    0.625780791593   -0.973248540587
 H    1.202184789141    2.023493791593   -2.075068540587
 H    1.640874789141    2.270204791593   -0.343758540587
 C   -0.582735210859   -1.964219208407    1.340751459413
 O   -0.065735210859   -1.076219208407    0.387751459413
 H    0.024264789141   -1.550219208407   -0.451248540587
 H    0.102264789141   -2.802219208407    1.483751459413
 H   -1.541735210859   -2.345219208407    0.983751459413
 H   -0.732975210859   -1.429297208407    2.290111459413
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-015LEU-102SER-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-015LEU-102SER-1-dimer.npy', np.array(charges))