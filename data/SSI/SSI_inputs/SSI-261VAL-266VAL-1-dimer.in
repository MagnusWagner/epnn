import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    2.151042491556    0.110375126750    0.416393294845
 C    2.444042491556    1.071375126750   -0.717606705155
 H    2.267042491556   -0.932624873250    0.130393294845
 H    2.831042491556    0.309375126750    1.242393294845
 H    1.144042491556    0.263375126750    0.786393294845
 H    3.494042491556    0.996375126750   -0.995606705155
 H    1.805882491556    0.797365126750   -1.570644705155
 H    2.238012491556    2.098615126750   -0.382447705155
 C   -1.543957508444   -0.708624873250   -0.035606705155
 C   -3.052957508444   -0.478624873250    0.327393294845
 H   -1.375957508444   -0.500624873250   -1.091606705155
 H   -0.944957508444   -0.021624873250    0.556393294845
 H   -1.245957508444   -1.730624873250    0.176393294845
 H   -3.306957508444    0.550375126750    0.070393294845
 H   -3.714377508444   -1.163054873250   -0.224033705155
 H   -3.170067508444   -0.601444873250    1.414223294845
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-261VAL-266VAL-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-261VAL-266VAL-1-dimer.npy', np.array(charges))