import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -0.043992439606    1.743973505604   -2.207267824332
 C   -0.280992439606    0.752973505604   -1.078267824332
 O    0.702007560394    0.191973505604   -0.545267824332
 O   -1.460992439606    0.518973505604   -0.732267824332
 H   -0.598992439606    2.664973505604   -2.024267824332
 H   -0.439992439606    1.296973505604   -3.121267824332
 H    1.022557560394    1.971648505604   -2.350907824332
 C    0.546007560394   -1.023026494396    2.747732175668
 N    0.464007560394   -1.880026494396    1.533732175668
 H    1.007007560394   -2.730026494396    1.624732175668
 H   -0.493992439606   -2.138026494396    1.327732175668
 H    0.793007560394   -1.353026494396    0.720732175668
 H   -0.016992439606   -1.484026494396    3.562732175668
 H    0.111007560394   -0.040026494396    2.536732175668
 H    1.583267560394   -0.899680494396    3.092522175668
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-147ASP-188LYS-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-147ASP-188LYS-1-dimer.npy', np.array(charges))