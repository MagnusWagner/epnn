import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -0.822509983367   -0.286493587356    2.105096222356
 C   -0.218509983367   -0.914493587356    0.876096222356
 O   -0.732509983367   -0.703493587356   -0.246903777644
 O    0.798490016633   -1.615493587356    1.058096222356
 H   -0.098509983367    0.441506412644    2.475096222356
 H   -0.961509983367   -1.033493587356    2.888096222356
 H   -1.773829983367    0.224196412644    1.894896222356
 C    0.032490016633    2.300506412644   -1.760903777644
 N    0.810490016633    1.011506412644   -1.740903777644
 H    0.944490016633    0.647506412644   -2.677903777644
 H    1.725490016633    1.124506412644   -1.302903777644
 H    0.293490016633    0.295506412644   -1.220903777644
 H    0.562490016633    3.006506412644   -2.411903777644
 H    0.015490016633    2.717506412644   -0.746903777644
 H   -1.007589983367    2.234256412644   -2.112823777644
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-080ASP-087LYS-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-080ASP-087LYS-1-dimer.npy', np.array(charges))