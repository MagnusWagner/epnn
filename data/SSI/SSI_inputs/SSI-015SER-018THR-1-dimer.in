import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    0.474358642000   -2.211571637810   -1.078431354036
 O   -0.080641358000   -0.911571637810   -1.020431354036
 H   -1.041641358000   -1.004571637810   -0.926431354036
 H    0.415358642000   -2.573571637810   -2.106431354036
 H   -0.097641358000   -2.888571637810   -0.442431354036
 H    1.525009642000   -2.208694637810   -0.752664354036
 C    0.455358642000    1.944428362190    0.974568645964
 O   -0.766641358000    1.215428362190    1.066568645964
 H   -0.733641358000    0.670428362190    1.862568645964
 H    1.281358642000    1.235428362190    0.910568645964
 H    0.442556642000    2.578150362190    0.075550645964
 H    0.585647642000    2.549804962190    1.883713645964
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-015SER-018THR-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-015SER-018THR-1-dimer.npy', np.array(charges))