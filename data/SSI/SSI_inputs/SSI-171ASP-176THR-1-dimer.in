import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C   -0.980359686745   -1.104105109964    1.248342464104
 C    0.475640313255   -0.957105109964    0.859342464104
 O    0.738640313255   -0.127105109964   -0.032657535896
 O    1.338640313255   -1.689105109964    1.406342464104
 H   -1.498359686745   -1.567105109964    0.407342464104
 H   -1.425359686745   -0.124105109964    1.411342464104
 H   -1.126229686745   -1.725115109964    2.144480464104
 C   -0.513359686745    2.082894890036   -2.233657535896
 O   -0.967359686745    1.532894890036   -1.008657535896
 H   -0.245359686745    0.958894890036   -0.657657535896
 H   -0.305359686745    1.294894890036   -2.952657535896
 H   -1.302879686745    2.752614890036   -2.605323135896
 H    0.410390313255    2.648144890036   -2.040842535896
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-171ASP-176THR-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-171ASP-176THR-1-dimer.npy', np.array(charges))