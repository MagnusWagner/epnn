import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -2.252862889069   -2.550282981973    0.142475813843
 C   -3.558862889069   -3.332282981973    0.084475813843
 H   -2.202862889069   -1.818282981973   -0.662524186157
 H   -2.199862889069   -2.018282981973    1.091475813843
 H   -1.406862889069   -3.230282981973    0.076475813843
 H   -4.350862889069   -2.592282981973    0.119475813843
 H   -3.641938589069   -3.934582981973   -0.832222186157
 H   -3.662255589069   -3.982282981973    0.965843813843
 C    2.633137110931   -0.098282981973   -1.479524186157
 C   -0.192862889069    0.375717018027    1.040475813843
 C   -0.321862889069    1.764717018027    1.057475813843
 C    0.758137110931   -0.228282981973    0.213475813843
 C    1.591137110931    0.547717018027   -0.596524186157
 C    0.499137110931    2.546717018027    0.248475813843
 C    1.454137110931    1.937717018027   -0.570524186157
 H   -0.827862889069   -0.231282981973    1.670475813843
 H   -1.051862889069    2.235717018027    1.701475813843
 H    0.828137110931   -1.301282981973    0.170475813843
 H    0.403137110931    3.624717018027    0.258475813843
 H    2.953137110931   -1.038282981973   -1.028524186157
 H    3.512137110931    0.546717018027   -1.507524186157
 H    2.095137110931    2.555717018027   -1.183524186157
 H    2.298641110931   -0.287692981973   -2.510173186157
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-043LEU-050PHE-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-043LEU-050PHE-1-dimer.npy', np.array(charges))