import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
1 1 
 C    0.297861986588    2.561723976331    0.843513786706
 O    0.850861986588    1.366723976331    0.297513786706
 H    1.812861986588    1.460723976331    0.318513786706
 H    0.686861986588    2.689723976331    1.853513786706
 H    0.584731986588    3.424490976331    0.224373786706
 H   -0.797488013412    2.474095876331    0.893793786706
 C   -1.263138013412   -2.233276023669   -0.914486213294
 N   -0.029138013412   -1.711276023669   -0.261486213294
 H    0.570861986588   -2.473276023669    0.035513786706
 H    0.510861986588   -1.126276023669   -0.888486213294
 H   -0.243138013412   -1.159276023669    0.561513786706
 H   -1.818138013412   -2.872276023669   -0.218486213294
 H   -1.000138013412   -2.837276023669   -1.789486213294
 H   -1.912845013412   -1.405261023669   -1.234286213294
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-004THR-132LYS-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-004THR-132LYS-1-dimer.npy', np.array(charges))