import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -0.121542704445    2.392655383494   -1.389095464125
 C    0.232457295555    0.970655383494   -0.941095464125
 O   -0.646542704445    0.346655383494   -0.408095464125
 O    1.361457295555    0.474655383494   -1.092095464125
 H   -0.309542704445    3.018655383494   -0.514095464125
 H   -1.008542704445    2.385655383494   -2.027095464125
 H    0.740658295555    2.769109383494   -1.959085464125
 C   -0.167542704445   -1.925344616506    2.530904535875
 N   -0.566542704445   -1.932344616506    1.086904535875
 H   -0.153542704445   -1.162344616506    0.556904535875
 H   -0.330542704445   -2.807344616506    0.637904535875
 H   -1.565542704445   -1.803344616506    0.992904535875
 H    0.763457295555   -2.482344616506    2.674904535875
 H   -0.946542704445   -2.355344616506    3.167904535875
 H    0.009931295555   -0.870438616506    2.787177535875
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-028GLU-097LYS-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-028GLU-097LYS-1-dimer.npy', np.array(charges))