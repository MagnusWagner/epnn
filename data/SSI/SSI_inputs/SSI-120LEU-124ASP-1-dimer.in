import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C    2.161140247250    0.055947768763    0.532059508876
 C    2.917140247250    1.018947768763    1.434059508876
 H    1.644140247250    0.599947768763   -0.254940491124
 H    2.862140247250   -0.637052231237    0.082059508876
 H    1.434140247250   -0.512052231237    1.113059508876
 H    3.632140247250    1.571947768763    0.827059508876
 H    2.216150247250    1.721387768763    1.908600508876
 H    3.481930247250    0.470777768763    2.202514508876
 C   -1.920859752750    0.328947768763    0.644059508876
 C   -1.253859752750   -0.312052231237   -0.561940491124
 O   -1.235859752750   -1.558052231237   -0.646940491124
 O   -0.759859752750    0.439947768763   -1.434940491124
 H   -2.596859752750    1.105947768763    0.284059508876
 H   -1.165859752750    0.820947768763    1.256059508876
 H   -2.499779752750   -0.396492231237    1.234470508876
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-120LEU-124ASP-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-120LEU-124ASP-1-dimer.npy', np.array(charges))