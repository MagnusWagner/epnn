import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -1.642892155939    2.575557943523   -0.685035050737
 C   -3.123892155939    2.931557943523   -0.824035050737
 H   -1.529892155939    1.493557943523   -0.683035050737
 H   -1.084892155939    2.972557943523   -1.529035050737
 H   -1.211892155939    2.975557943523    0.224964949263
 H   -3.220892155939    4.017557943523   -0.815035050737
 H   -3.689532155939    2.497657943523    0.013684949263
 H   -3.529662155939    2.573817943523   -1.781835050737
 C    2.672107844061   -1.954442056477   -1.530035050737
 C   -0.276892155939   -0.219442056477    1.030964949263
 C    0.992107844061    0.332557943523    0.972964949263
 C   -0.594892155939   -1.311442056477    0.237964949263
 C    1.932107844061   -0.211442056477    0.117964949263
 C    0.366107844061   -1.879442056477   -0.575035050737
 C    1.627107844061   -1.319442056477   -0.664035050737
 O   -1.231892155939    0.277557943523    1.860964949263
 H    1.244107844061    1.177557943523    1.594964949263
 H   -0.909892155939    1.032557943523    2.378964949263
 H   -1.582892155939   -1.737442056477    0.296964949263
 H    2.922107844061    0.222557943523    0.068964949263
 H    0.132107844061   -2.757442056477   -1.160035050737
 H    3.319107844061   -1.170442056477   -1.914035050737
 H    2.180107844061   -2.425442056477   -2.383035050737
 H    3.283157844061   -2.704304056477   -1.006275050737
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-003VAL-009TYR-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-003VAL-009TYR-1-dimer.npy', np.array(charges))