import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C    0.033732944853   -1.125511797114    1.580406987928
 C    0.784732944853   -1.165511797114    0.291406987928
 O    0.666732944853   -0.174511797114   -0.463593012072
 O    1.521732944853   -2.153511797114    0.048406987928
 H   -1.041267055147   -1.075511797114    1.390406987928
 H    0.317732944853   -0.230511797114    2.136406987928
 H    0.264722944853   -2.016378797114    2.182900987928
 C   -2.103267055147    2.116488202886   -0.821593012072
 O   -0.712267055147    2.192488202886   -0.525593012072
 H   -0.329267055147    1.293488202886   -0.603593012072
 H   -2.471267055147    1.129488202886   -0.531593012072
 H   -2.632087055147    2.887778202886   -0.242406012072
 H   -2.239007055147    2.240855802886   -1.906078012072
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-004GLU-039THR-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-004GLU-039THR-1-dimer.npy', np.array(charges))