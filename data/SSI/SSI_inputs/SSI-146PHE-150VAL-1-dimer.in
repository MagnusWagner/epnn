import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    1.172320991139    1.312203978451   -2.291727208952
 C    0.845320991139    0.505203978451    1.404272791048
 C    0.975320991139   -0.882796021549    1.402272791048
 C    0.920320991139    1.211203978451    0.205272791048
 C    1.126320991139    0.544203978451   -1.001727208952
 C    1.184320991139   -1.559796021549    0.200272791048
 C    1.262320991139   -0.848796021549   -0.997727208952
 H    0.681320991139    1.034203978451    2.327272791048
 H    0.912320991139   -1.434796021549    2.331272791048
 H    0.801320991139    2.283203978451    0.205272791048
 H    1.287320991139   -2.635796021549    0.198272791048
 H    2.219320991139    1.403203978451   -2.584727208952
 H    0.772320991139    2.312203978451   -2.123727208952
 H    1.458320991139   -1.399796021549   -1.903727208952
 H    0.607010991139    0.833923978451   -3.105167208952
 C   -2.549679008861   -0.089796021549    0.761272791048
 C   -4.018679008861   -0.298796021549    0.412272791048
 H   -1.899679008861   -0.373796021549   -0.060727208952
 H   -2.372679008861    0.961203978451    0.985272791048
 H   -2.282679008861   -0.687796021549    1.632272791048
 H   -4.270679008861    0.354203978451   -0.423727208952
 H   -4.191599008861   -1.347036021549    0.127172791048
 H   -4.651089008861   -0.027146021549    1.270332791048
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-146PHE-150VAL-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-146PHE-150VAL-1-dimer.npy', np.array(charges))