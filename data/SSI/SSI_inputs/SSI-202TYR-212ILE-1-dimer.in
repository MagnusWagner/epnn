import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    1.536500586999   -2.832498943073    0.505420478688
 C   -0.013499413001    0.641501056927    0.731420478688
 C    0.193500586999   -0.722498943073    0.865420478688
 C    0.932500586999    1.415501056927    0.063420478688
 C    1.331500586999   -1.338498943073    0.348420478688
 C    2.061500586999    0.820501056927   -0.471579521312
 C    2.259500586999   -0.544498943073   -0.340579521312
 O    0.733500586999    2.754501056927   -0.069579521312
 H   -0.916499413001    1.088501056927    1.112420478688
 H   -0.548499413001   -1.323498943073    1.378420478688
 H   -0.171499413001    2.942501056927    0.162420478688
 H    2.788500586999    1.428501056927   -0.991579521312
 H    1.199500586999   -3.124498943073    1.501420478688
 H    2.601500586999   -3.055498943073    0.437420478688
 H    3.148500586999   -0.995498943073   -0.762579521312
 H    0.976320586999   -3.426608943073   -0.231621521312
 C   -3.304499413001   -0.339498943073   -0.960579521312
 C   -4.715499413001   -0.116498943073   -0.490579521312
 H   -2.969499413001   -1.345498943073   -0.709579521312
 H   -3.263499413001   -0.235498943073   -2.044579521312
 H   -2.638499413001    0.390501056927   -0.503579521312
 H   -5.343499413001   -0.851498943073   -0.957579521312
 H   -5.007499413001    0.860501056927   -0.873579521312
 H   -4.848349413001   -0.151498943073    0.600807478688
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-202TYR-212ILE-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-202TYR-212ILE-1-dimer.npy', np.array(charges))