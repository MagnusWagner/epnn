import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C    1.642817613955    0.934614346484    1.220720198967
 C    2.200817613955    1.046614346484   -0.189279801033
 O    3.207817613955    1.707614346484   -0.454279801033
 N    1.533817613955    0.386614346484   -1.116279801033
 H    1.868817613955    0.460614346484   -2.070279801033
 H    0.713817613955   -0.162385653516   -0.870279801033
 H    1.334817613955   -0.097385653516    1.398720198967
 H    0.734817613955    1.527614346484    1.277720198967
 H    2.350347613955    1.240826646484    2.005340198967
 C   -2.373182386045    0.279614346484    0.742720198967
 C   -2.134182386045   -1.084385653516    0.113720198967
 O   -0.991182386045   -1.293385653516   -0.353279801033
 O   -3.047182386045   -1.940385653516    0.089720198967
 H   -2.092182386045    1.037614346484    0.009720198967
 H   -1.723182386045    0.394614346484    1.613720198967
 H   -3.414352386045    0.440074046484    1.059280198967
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-002ASN-022GLU-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-002ASN-022GLU-1-dimer.npy', np.array(charges))