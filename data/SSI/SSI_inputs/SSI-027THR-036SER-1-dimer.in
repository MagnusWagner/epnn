import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -1.629343053851    1.724972708224   -0.533252297615
 O   -0.340343053851    1.159972708224   -0.778252297615
 H    0.230656946149    1.876972708224   -1.088252297615
 H   -1.943343053851    2.273972708224   -1.422252297615
 H   -2.358703053851    0.924032708224   -0.342142297615
 H   -1.582443053851    2.432072708224    0.308057702385
 C    1.436656946149   -1.942027291776    0.403747702385
 O    0.496656946149   -1.041027291776    0.964747702385
 H    0.394656946149   -0.289027291776    0.352747702385
 H    2.327656946149   -1.965027291776    1.033747702385
 H    1.725656946149   -1.599027291776   -0.592252297615
 H    1.019326946149   -2.957287291776    0.332517702385
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-027THR-036SER-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-027THR-036SER-1-dimer.npy', np.array(charges))