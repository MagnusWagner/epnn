import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C   -1.537019338436    0.078382987243   -0.206745540270
 C   -1.556019338436   -1.449617012757   -0.219745540270
 C   -0.705019338436    0.629382987243    0.932254459730
 O   -1.261019338436    1.374382987243    1.768254459730
 O    0.507980661564    0.323382987243    0.982254459730
 H   -1.126019338436    0.462382987243   -1.137745540270
 H   -2.565019338436    0.441382987243   -0.122745540270
 H   -2.245019338436   -1.790617012757    0.551254459730
 H   -0.567019338436   -1.841617012757    0.013254459730
 H   -1.863969338436   -1.858540012757   -1.193370540270
 C    2.762980661564   -0.631617012757   -1.481745540270
 O    1.399980661564   -0.238617012757   -1.582745540270
 H    1.105980661564   -0.044617012757   -0.667745540270
 H    3.215980661564   -0.119617012757   -0.632745540270
 H    2.805385661564   -1.719781012757   -1.326498540270
 H    3.296749661564   -0.333081012757   -2.396057540270
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-012GLU-019THR-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-012GLU-019THR-1-dimer.npy', np.array(charges))