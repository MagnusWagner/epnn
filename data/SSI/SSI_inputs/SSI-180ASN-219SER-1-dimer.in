import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -0.550898380213   -0.342213089995   -1.558441600970
 C    0.746101619787   -0.820213089995   -0.960441600970
 O    1.336101619787   -1.785213089995   -1.456441600970
 N    1.189101619787   -0.185213089995    0.108558399030
 H    2.036101619787   -0.487213089995    0.562558399030
 H    0.629101619787    0.548786910005    0.531558399030
 H   -0.337898380213    0.355786910005   -2.362441600970
 H   -1.126898380213    0.181786910005   -0.800441600970
 H   -1.128628380213   -1.188923089995   -1.957571600970
 C   -1.914898380213    1.724786910005    1.603558399030
 O   -0.631898380213    1.156786910005    1.839558399030
 H   -0.551898380213    0.804786910005    2.745558399030
 H   -1.887898380213    2.270786910005    0.663558399030
 H   -2.166898380213    2.419786910005    2.404558399030
 H   -2.686978380213    0.945476910005    1.522588399030
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-180ASN-219SER-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-180ASN-219SER-1-dimer.npy', np.array(charges))