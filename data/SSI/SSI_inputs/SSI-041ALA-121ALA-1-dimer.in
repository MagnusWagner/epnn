import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -1.110199214563   -1.640245815442    0.521576871772
 C   -0.517199214563   -2.986245815442    0.159576871772
 H   -0.325199214563   -0.962245815442    0.852576871772
 H   -1.612199214563   -1.211245815442   -0.347423128228
 H   -1.838199214563   -1.761245815442    1.325576871772
 H   -1.336199214563   -3.650245815442   -0.126423128228
 H   -0.006735214563   -3.413261815442    1.035406871772
 H    0.160151785437   -2.904759815442   -0.703303128228
 C    0.422800785437    1.664754184558   -0.355423128228
 C    1.211800785437    2.964754184558   -0.327423128228
 H   -0.603199214563    1.850754184558   -0.678423128228
 H    0.874800785437    0.966754184558   -1.058423128228
 H    0.415800785437    1.224754184558    0.642576871772
 H    2.179800785437    2.774754184558    0.139576871772
 H    0.632802785437    3.679674184558    0.275606871772
 H    1.372607785437    3.370394184558   -1.337173128228
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-041ALA-121ALA-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-041ALA-121ALA-1-dimer.npy', np.array(charges))