import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -2.530375816245    0.604476522232   -2.851310307753
 C   -0.280375816245   -1.885523477768   -1.471310307753
 C   -1.368375816245   -0.181523477768   -2.333310307753
 C   -0.054375816245    0.156476522232   -2.261310307753
 N   -1.487375816245   -1.466523477768   -1.841310307753
 N    0.603624183755   -0.924523477768   -1.717310307753
 H   -0.048375816245   -2.855523477768   -1.047310307753
 H    1.608624183755   -0.994523477768   -1.541310307753
 H    0.388624183755    1.085476522232   -2.591310307753
 H   -3.033375816245    0.010476522232   -3.615310307753
 H   -2.141375816245    1.506476522232   -3.327310307753
 H   -3.257394816245    0.892116522232   -2.077550307753
 C   -0.576375816245    1.988476522232    1.126689692247
 C    0.353624183755   -0.340523477768    1.759689692247
 C    0.351624183755    1.016476522232    1.784689692247
 C    2.106624183755    0.323476522232    2.915689692247
 N    1.450624183755   -0.750523477768    2.487689692247
 N    1.467624183755    1.414476522232    2.498689692247
 H   -0.372375816245   -0.966523477768    1.255689692247
 H    1.734624183755   -1.709523477768    2.656689692247
 H   -1.245375816245    1.441476522232    0.464689692247
 H    0.029624183755    2.644476522232    0.500689692247
 H    3.019624183755    0.310476522232    3.502689692247
 H   -1.160935816245    2.606916522232    1.823699692247
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-044HIE-067HIE-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-044HIE-067HIE-1-dimer.npy', np.array(charges))