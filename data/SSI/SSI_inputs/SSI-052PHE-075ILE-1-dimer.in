import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    2.573371830304    0.356713244647   -1.571969500390
 C   -0.692628169696    1.064713244647    0.224030499610
 C    0.665371830304    1.015713244647   -0.079969500390
 C   -1.622628169696    0.466713244647   -0.607969500390
 C    1.104371830304    0.350713244647   -1.216969500390
 C   -1.202628169696   -0.187286755353   -1.757969500390
 C    0.169371830304   -0.271286755353   -2.052969500390
 H   -1.024628169696    1.581713244647    1.114030499610
 H    1.375371830304    1.493713244647    0.579030499610
 H   -2.676628169696    0.519713244647   -0.367969500390
 H   -1.925628169696   -0.636286755353   -2.423969500390
 H    2.828371830304   -0.585286755353   -2.060969500390
 H    3.158371830304    0.431713244647   -0.658969500390
 H    0.493371830304   -0.790286755353   -2.942969500390
 H    2.856821830304    1.199181244647   -2.219969500390
 C   -0.198628169696   -1.668286755353    2.612030499610
 C   -0.935628169696   -0.778286755353    3.637030499610
 H    0.549371830304   -2.285286755353    3.108030499610
 H   -0.919628169696   -2.330286755353    2.131030499610
 H    0.281371830304   -1.061286755353    1.845030499610
 H   -1.309628169696   -1.393286755353    4.454030499610
 H   -1.775628169696   -0.299286755353    3.133030499610
 H   -0.248453169696   -0.005214755353    4.011400499610
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-052PHE-075ILE-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-052PHE-075ILE-1-dimer.npy', np.array(charges))