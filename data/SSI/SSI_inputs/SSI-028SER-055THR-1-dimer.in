import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -1.447514890109   -0.462846382827    1.929990067473
 O   -0.673514890109   -0.796846382827    0.786990067473
 H   -0.293514890109   -1.694846382827    0.873990067473
 H   -2.104514890109   -1.294846382827    2.184990067473
 H   -2.060514890109    0.408153617173    1.694990067473
 H   -0.783024890109   -0.228746382827    2.774773067473
 C    1.761485109891    0.748153617173   -1.425009932527
 O    0.359485109891    0.605153617173   -1.333009932527
 H    0.127485109891    0.132153617173   -0.510009932527
 H    2.218485109891   -0.239846382827   -1.388009932527
 H    1.986025109891    1.222493617173   -2.391746932527
 H    2.155065109891    1.340683617173   -0.585956932527
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-028SER-055THR-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-028SER-055THR-1-dimer.npy', np.array(charges))