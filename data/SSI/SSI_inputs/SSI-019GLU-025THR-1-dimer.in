import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C    1.613306547881   -0.033980097324    1.002523809132
 C    0.264306547881    0.661019902676    1.180523809132
 O   -0.532693452119    0.633019902676    0.211523809132
 O   -0.060693452119    1.121019902676    2.300523809132
 H    1.979306547881    0.120019902676   -0.013476190868
 H    1.459306547881   -1.107980097324    1.122523809132
 H    2.366436547881    0.282447902676    1.739185809132
 C   -0.752693452119   -0.940980097324   -2.860476190868
 O   -0.434693452119   -1.284980097324   -1.517476190868
 H   -0.384693452119   -0.452980097324   -0.985476190868
 H   -0.787693452119    0.144019902676   -2.945476190868
 H    0.030386547881   -1.339082097324   -3.522520190868
 H   -1.740893452119   -1.352730097324   -3.113305190868
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-019GLU-025THR-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-019GLU-025THR-1-dimer.npy', np.array(charges))