import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-2 1 
 C    0.436262025090    0.633384669051   -2.156768006411
 C    1.495262025090    0.709384669051   -1.050768006411
 O    1.134262025090    1.081384669051    0.084231993589
 O    2.690262025090    0.432384669051   -1.306768006411
 H    0.107262025090    1.650384669051   -2.382768006411
 H   -0.446737974910    0.093384669051   -1.809768006411
 H    0.796432025090    0.193894669051   -3.098638006411
 C   -0.383737974910   -1.514615330949    1.725231993589
 C   -1.493737974910   -0.673615330949    1.069231993589
 O   -2.554737974910   -1.237615330949    0.701231993589
 O   -1.320737974910    0.559384669051    0.933231993589
 H   -0.122737974910   -1.088615330949    2.697231993589
 H    0.507262025090   -1.478615330949    1.099231993589
 H   -0.676377974910   -2.564275330949    1.875491993589
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-075GLU-079GLU-2-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-075GLU-079GLU-2-dimer.npy', np.array(charges))