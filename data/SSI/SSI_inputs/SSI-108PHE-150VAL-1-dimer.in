import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    3.036758852957    0.553095073683   -0.741551130184
 C   -0.535241147043   -1.334904926317    0.727448869816
 C    0.328758852957   -0.702904926317    1.616448869816
 C   -0.238241147043   -1.361904926317   -0.629551130184
 C    1.490758852957   -0.084904926317    1.138448869816
 C    0.924758852957   -0.750904926317   -1.103551130184
 C    1.788758852957   -0.097904926317   -0.226551130184
 H   -1.435241147043   -1.808904926317    1.094448869816
 H    0.102758852957   -0.685904926317    2.673448869816
 H   -0.905241147043   -1.860904926317   -1.318551130184
 H    2.163758852957    0.398095073683    1.832448869816
 H    1.149758852957   -0.778904926317   -2.160551130184
 H    3.344758852957    1.341095073683   -0.056551130184
 H    2.798758852957    1.023095073683   -1.695551130184
 H    3.873031852957   -0.145235926317   -0.893141130184
 C   -3.202241147043    1.145095073683    0.314448869816
 C   -2.971241147043    2.048095073683   -0.900551130184
 H   -4.057241147043    0.492095073683    0.148448869816
 H   -2.326241147043    0.529095073683    0.484448869816
 H   -3.380241147043    1.755095073683    1.193448869816
 H   -2.934241147043    1.409095073683   -1.781551130184
 H   -3.806508147043    2.755742073683   -1.008101130184
 H   -2.003797347043    2.567475073683   -0.835001130184
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-108PHE-150VAL-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-108PHE-150VAL-1-dimer.npy', np.array(charges))