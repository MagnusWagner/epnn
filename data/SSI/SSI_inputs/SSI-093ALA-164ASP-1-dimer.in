import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C   -0.300973100895   -1.429524699165   -2.000963204315
 C    1.162026899105   -1.671524699165   -1.556963204315
 H   -0.705973100895   -2.330524699165   -2.459963204315
 H   -0.905973100895   -1.181524699165   -1.128963204315
 H   -0.344973100895   -0.601524699165   -2.710963204315
 H    1.555026899105   -0.756524699165   -1.116963204315
 H    1.768316899105   -1.924955699165   -2.439113204315
 H    1.212506899105   -2.468520699165   -0.800493204315
 C   -0.296973100895    2.071475300835    0.242036795685
 C   -0.215973100895    0.728475300835    0.954036795685
 O   -1.255973100895    0.141475300835    1.304036795685
 O    0.893026899105    0.215475300835    1.132036795685
 H   -0.790973100895    1.901475300835   -0.716963204315
 H    0.701026899105    2.461475300835    0.029036795685
 H   -0.873623100895    2.820691300835    0.804306795685
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-093ALA-164ASP-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-093ALA-164ASP-1-dimer.npy', np.array(charges))