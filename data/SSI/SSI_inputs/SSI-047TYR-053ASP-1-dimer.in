import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C    1.031976932334   -4.109657625846   -1.723105104147
 C   -0.596023067666   -0.228657625846   -0.786105104147
 C   -1.233023067666   -1.058657625846   -1.697105104147
 C    0.564976932334   -0.656657625846   -0.145105104147
 C   -0.693023067666   -2.298657625846   -1.994105104147
 C    1.096976932334   -1.910657625846   -0.446105104147
 C    0.461976932334   -2.752657625846   -1.365105104147
 O   -1.132023067666    0.995342374154   -0.551105104147
 H   -2.045023067666    1.056342374154   -0.832105104147
 H   -2.182023067666   -0.828657625846   -2.134105104147
 H    1.034976932334   -0.016657625846    0.585894895853
 H   -1.197023067666   -2.928657625846   -2.698105104147
 H    1.980976932334   -2.249657625846    0.072894895853
 H    0.228976932334   -4.844657625846   -1.678105104147
 H    1.785976932334   -4.392657625846   -0.988105104147
 H    1.478564932334   -4.139527625846   -2.727925104147
 C    0.774976932334    2.464342374154    3.252894895853
 C    0.120976932334    2.700342374154    1.918894895853
 O   -1.092023067666    2.985342374154    1.858894895853
 O    0.830976932334    2.615342374154    0.910894895853
 H    1.838976932334    2.340342374154    3.106894895853
 H    0.410976932334    1.524342374154    3.657894895853
 H    0.558685932334    3.275252374154    3.963974895853
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-047TYR-053ASP-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-047TYR-053ASP-1-dimer.npy', np.array(charges))