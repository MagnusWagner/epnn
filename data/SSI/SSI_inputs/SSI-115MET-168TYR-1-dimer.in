import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    0.403835633241    0.476025516316   -3.335600208939
 C    0.821835633241   -0.731974483684   -4.158600208939
 C   -0.521164366759    1.437025516316   -4.084600208939
 H   -0.106164366759    0.136025516316   -2.440600208939
 H    1.269835633241    1.026025516316   -3.008600208939
 H   -0.089164366759   -1.183974483684   -4.552600208939
 H   -0.600164366759    2.365025516316   -3.517600208939
 H   -0.084164366759    1.678025516316   -5.053600208939
 H    1.366877633241   -1.455934483684   -3.535050208939
 H    1.445900633241   -0.432274483684   -5.013420208939
 H   -1.534329366759    1.036385516316   -4.236210208939
 C    2.308835633241    1.089025516316    2.722399791061
 C   -0.041164366759   -0.707974483684    0.313399791061
 C   -1.227164366759   -0.738974483684    1.043399791061
 C    1.101835633241   -0.121974483684    0.840399791061
 C    1.092835633241    0.415025516316    2.139399791061
 C   -1.245164366759   -0.216974483684    2.339399791061
 C   -0.090164366759    0.351025516316    2.877399791061
 O   -2.336164366759   -1.263974483684    0.446399791061
 H   -0.023164366759   -1.143974483684   -0.672600208939
 H    2.005835633241   -0.079974483684    0.246399791061
 H   -2.158164366759   -0.237974483684    2.917399791061
 H   -3.125164366759   -1.183974483684    1.012399791061
 H    1.976835633241    1.792025516316    3.485399791061
 H    2.787835633241    1.684025516316    1.943399791061
 H   -0.118164366759    0.764025516316    3.876399791061
 H    3.052522633241    0.410135516316    3.165159791061
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-115MET-168TYR-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-115MET-168TYR-1-dimer.npy', np.array(charges))