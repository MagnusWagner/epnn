import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C    2.328350980987    1.042612184354   -0.012483901460
 C    2.760350980987   -0.212387815646    0.749516098540
 H    3.157350980987    1.743612184354   -0.098483901460
 H    1.986350980987    0.764612184354   -1.008483901460
 H    1.505350980987    1.527612184354    0.507516098540
 H    1.939350980987   -0.921387815646    0.799516098540
 H    3.074830980987    0.048422184354    1.770826098540
 H    3.586000980987   -0.716467815646    0.225876098540
 C   -2.223649019013    0.870612184354   -0.003483901460
 C   -1.238649019013   -0.270387815646   -0.199483901460
 O   -1.425649019013   -1.070387815646   -1.143483901460
 O   -0.285649019013   -0.374387815646    0.593516098540
 H   -1.925649019013    1.500612184354    0.839516098540
 H   -3.206649019013    0.456612184354    0.237516098540
 H   -2.322709019013    1.493902184354   -0.904423901460
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-008ALA-035GLU-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-008ALA-035GLU-1-dimer.npy', np.array(charges))