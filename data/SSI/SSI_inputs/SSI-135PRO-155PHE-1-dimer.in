import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -0.205901513533    2.408081757102   -1.732336509926
 C   -0.195901513533    1.070081757102   -2.443336509926
 C   -1.548901513533    2.990081757102   -2.110336509926
 H    0.618098486467    3.042081757102   -2.060336509926
 H   -0.172901513533    2.265081757102   -0.653336509926
 H    0.089098486467    1.215081757102   -3.486336509926
 H    0.491098486467    0.382081757102   -1.952336509926
 H   -1.453901513533    3.543081757102   -3.042336509926
 H   -1.932901513533    3.644081757102   -1.325336509926
 H   -1.241157513533    0.732491757102   -2.384427509926
 H   -2.199803513533    2.116281757102   -2.261311509926
 C    2.398098486467   -1.367918242898   -0.214336509926
 C    0.695098486467    0.118081757102    0.855663490074
 C    1.127098486467   -1.161918242898    0.561663490074
 C   -0.494901513533    0.317081757102    1.525663490074
 C    0.359098486467   -2.244918242898    0.958663490074
 C   -1.280901513533   -0.765918242898    1.897663490074
 C   -0.837901513533   -2.051918242898    1.632663490074
 H    1.291098486467    0.972081757102    0.563663490074
 H   -0.820901513533    1.323081757102    1.750663490074
 H    2.498098486467   -0.565918242898   -0.948336509926
 H    2.302098486467   -2.299918242898   -0.773336509926
 H    0.695098486467   -3.249918242898    0.746663490074
 H   -2.217901513533   -0.604918242898    2.413663490074
 H   -1.435901513533   -2.902918242898    1.923663490074
 H    3.312258486467   -1.405859242898    0.396296490074
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-135PRO-155PHE-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-135PRO-155PHE-1-dimer.npy', np.array(charges))