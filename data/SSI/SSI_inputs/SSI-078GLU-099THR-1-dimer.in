import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C    1.253123255691   -0.967633078825   -1.274089657451
 C   -0.155876744309   -1.153633078825   -0.704089657451
 O   -0.286876744309   -1.552633078825    0.476910342549
 O   -1.132876744309   -0.924633078825   -1.456089657451
 H    1.919123255691   -0.589633078825   -0.496089657451
 H    1.246123255691   -0.220633078825   -2.069089657451
 H    1.667155455691   -1.909592078825   -1.663049657451
 C   -0.371876744309    2.110366921175    0.920910342549
 C    0.684123255691    2.406366921175    1.982910342549
 H    0.059123255691    2.184366921175   -0.078089657451
 H   -0.762876744309    1.105366921175    1.069910342549
 H   -1.195876744309    2.816366921175    1.010910342549
 H    0.269123255691    2.147366921175    2.957910342549
 H    0.970705255691    3.468363921175    1.988630342549
 H    1.577325955691    1.791614921175    1.797790342549
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-078GLU-099THR-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-078GLU-099THR-1-dimer.npy', np.array(charges))