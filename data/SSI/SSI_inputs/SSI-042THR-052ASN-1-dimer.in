import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -1.090216807255    1.061090418483    2.894777497796
 O    0.076783192745    0.462090418483    2.341777497796
 H    0.705783192745    0.297090418483    3.059777497796
 H   -1.314216807255    0.580090418483    3.846777497796
 H   -0.921396807255    2.135960418483    3.056477497796
 H   -1.942476807255    0.884310418483    2.222177497796
 C    0.057783192745   -0.120909581517   -2.827222502204
 C    0.283783192745   -0.467909581517   -1.382222502204
 O    0.628783192745   -1.598909581517   -1.063222502204
 N    0.083783192745    0.497090418483   -0.499222502204
 H    0.197783192745    0.311090418483    0.491777497796
 H   -0.120216807255    1.436090418483   -0.822222502204
 H   -0.699216807255    0.654090418483   -2.893222502204
 H   -0.331216807255   -1.002909581517   -3.335222502204
 H    0.977263192745    0.216330418483   -3.328022502204
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-042THR-052ASN-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-042THR-052ASN-1-dimer.npy', np.array(charges))