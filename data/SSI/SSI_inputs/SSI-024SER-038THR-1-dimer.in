import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    1.337514218840   -1.386217316343   -1.631402400522
 O    1.036514218840   -0.248217316343   -0.852402400522
 H    0.772514218840    0.466782683657   -1.447402400522
 H    2.222514218840   -1.171217316343   -2.232402400522
 H    0.509514218840   -1.582217316343   -2.315402400522
 H    1.528024218840   -2.290762016343   -1.035162400522
 C   -1.171485781160    1.094782683657    1.911597599478
 O   -1.170485781160    0.446782683657    0.666597599478
 H   -1.376485781160    1.104782683657   -0.007402400522
 H   -2.178485781160    1.439782683657    2.147597599478
 H   -0.833955781160    0.395668683657    2.690897599478
 H   -0.494285781160    1.955865683657    1.811897599478
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-024SER-038THR-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-024SER-038THR-1-dimer.npy', np.array(charges))