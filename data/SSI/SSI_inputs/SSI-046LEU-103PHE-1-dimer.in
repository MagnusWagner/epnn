import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -1.954078734751   -3.375464536164   -0.486538214687
 C   -0.973078734751   -4.512464536164   -0.725538214687
 H   -2.797078734751   -3.748464536164    0.088461785313
 H   -1.464078734751   -2.598464536164    0.094461785313
 H   -2.301078734751   -2.957464536164   -1.428538214687
 H   -0.643078734751   -4.873464536164    0.240461785313
 H   -1.437290734751   -5.368805536164   -1.236608214687
 H   -0.085288734751   -4.141064536164   -1.258358214687
 C    2.535921265249    2.558535463836    0.290461785313
 C   -1.077078734751    0.342535463836    0.105461785313
 C   -1.024078734751    1.476535463836    0.901461785313
 C    0.014921265249   -0.104464536164   -0.616538214687
 C    0.157921265249    2.193535463836    0.981461785313
 C    1.202921265249    0.618535463836   -0.536538214687
 C    1.269921265249    1.756535463836    0.251461785313
 H   -2.004078734751   -0.211464536164    0.051461785313
 H   -1.895078734751    1.797535463836    1.453461785313
 H   -0.054078734751   -0.987464536164   -1.235538214687
 H    0.210921265249    3.085535463836    1.589461785313
 H    2.064921265249    0.293535463836   -1.101538214687
 H    2.271921265249    3.615535463836    0.251461785313
 H    3.097921265249    2.340535463836   -0.619538214687
 H    3.210231265249    2.397018463836    1.144401785313
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-046LEU-103PHE-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-046LEU-103PHE-1-dimer.npy', np.array(charges))