import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -1.562668219651    0.828001115027   -0.316618639309
 C   -2.786668219651    0.862001115027    0.600381360691
 H   -1.348668219651   -0.195998884973   -0.620618639309
 H   -1.751668219651    1.438001115027   -1.201618639309
 H   -0.688668219651    1.239001115027    0.185381360691
 H   -2.900668219651    1.874001115027    0.990381360691
 H   -2.663268219651    0.154416115027    1.433501360691
 H   -3.684338219651    0.599462115027    0.021361360691
 C    2.131331780349   -0.152998884973   -0.450618639309
 C    2.220331780349   -1.539998884973    0.171381360691
 H    3.106331780349    0.152001115027   -0.832618639309
 H    1.418331780349   -0.168998884973   -1.274618639309
 H    1.788331780349    0.567001115027    0.292381360691
 H    1.220331780349   -1.842998884973    0.472381360691
 H    2.884621780349   -1.514917884973    1.047791360691
 H    2.591621780349   -2.265301884973   -0.567588639309
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-143VAL-147LEU-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-143VAL-147LEU-1-dimer.npy', np.array(charges))