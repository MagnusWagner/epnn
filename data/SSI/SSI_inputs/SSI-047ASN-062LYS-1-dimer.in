import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -0.743818630155   -0.728608018867    0.592533451504
 C   -2.126818630155   -0.610608018867   -0.094466548496
 C   -0.627818630155   -0.064608018867    1.954533451504
 O    0.433181369845    0.413391981133    2.337533451504
 N   -1.677818630155    0.070391981133    2.744533451504
 H   -0.460818630155   -1.778608018867    0.697533451504
 H    0.002181369845   -0.250608018867   -0.011466548496
 H   -2.024818630155   -1.101608018867   -1.066466548496
 H   -1.490818630155    0.701391981133    3.514533451504
 H   -2.595818630155   -0.191608018867    2.439533451504
 H   -2.408408630155    0.444400981133   -0.227376548496
 H   -2.872548630155   -1.204602018867    0.454223451504
 C    1.052181369845    0.210391981133   -2.503466548496
 C    1.786181369845    1.134391981133   -1.555466548496
 C    1.932181369845   -0.482608018867   -3.513466548496
 H    0.576181369845   -0.573608018867   -1.923466548496
 H    0.266181369845    0.770391981133   -3.014466548496
 H    2.617181369845    0.602391981133   -1.087466548496
 H    1.082181369845    1.401391981133   -0.771466548496
 H    2.263181369845    0.227391981133   -4.281466548496
 H    2.819181369845   -0.871608018867   -2.998466548496
 H    2.159241369845    2.047437981133   -2.042476548496
 H    1.358481369845   -1.312119018867   -3.952526548496
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-047ASN-062LYS-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-047ASN-062LYS-1-dimer.npy', np.array(charges))