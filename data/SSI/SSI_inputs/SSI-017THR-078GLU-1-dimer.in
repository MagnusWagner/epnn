import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C    2.124315389470    1.350109995527    1.381810385914
 O    1.324315389470    1.752109995527    0.269810385914
 H    0.519315389470    1.189109995527    0.239810385914
 H    3.065315389470    1.898109995527    1.329810385914
 H    1.603535389470    1.625561995527    2.310744085914
 H    2.355135389470    0.275357995527    1.341417085914
 C   -0.998684610530   -1.976890004473    0.417810385914
 C   -0.935684610530   -0.772890004473   -0.506189614086
 O   -1.040684610530    0.344109995527    0.034810385914
 O   -0.710684610530   -0.932890004473   -1.729189614086
 H   -1.698684610530   -1.747890004473    1.220810385914
 H   -0.014684610530   -2.132890004473    0.847810385914
 H   -1.313934610530   -2.904620004473   -0.082124614086
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-017THR-078GLU-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-017THR-078GLU-1-dimer.npy', np.array(charges))