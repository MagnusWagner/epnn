import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    0.272039726795   -1.788141343391    1.320864719409
 O   -0.426960273205   -1.382141343391    0.153864719409
 H   -0.420960273205   -2.118141343391   -0.490135280591
 H    0.110039726795   -2.851141343391    1.493864719409
 H    1.343179726795   -1.572047343391    1.194514719409
 H   -0.149880273205   -1.213979343391    2.158904719409
 C    0.518039726795    1.952858656609   -1.183135280591
 O   -0.343960273205    1.325858656609   -0.243135280591
 H   -0.270960273205    0.352858656609   -0.296135280591
 H    0.018039726795    2.819858656609   -1.617135280591
 H    0.751039726795    1.241858656609   -1.978135280591
 H    1.447229726795    2.272719656609   -0.688875280591
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-181THR-195SER-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-181THR-195SER-1-dimer.npy', np.array(charges))