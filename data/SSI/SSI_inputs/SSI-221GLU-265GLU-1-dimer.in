import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-2 1 
 C   -1.679780470823   -3.326776355828   -0.818016742157
 C   -1.169780470823   -1.938776355828   -0.440016742157
 O    0.058219529177   -1.688776355828   -0.435016742157
 O   -2.053780470823   -1.084776355828   -0.164016742157
 H   -2.462780470823   -3.242776355828   -1.575016742157
 H   -2.138780470823   -3.766776355828    0.069983257843
 H   -0.902780470823   -4.020736355828   -1.171136742157
 C    0.923219529177    3.382223644172    0.463983257843
 C    1.199219529177    1.920223644172    0.420983257843
 O    1.148219529177    1.167223644172   -0.601016742157
 O    1.540219529177    1.570223644172    1.568983257843
 H    0.316219529177    3.565223644172   -0.382016742157
 H    1.911219529177    3.731223644172    0.193983257843
 H    0.938139529177    3.867563644172    1.451013257843
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-221GLU-265GLU-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-221GLU-265GLU-1-dimer.npy', np.array(charges))