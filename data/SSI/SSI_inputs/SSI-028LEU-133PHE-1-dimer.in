import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -0.934488267566   -0.269569009858   -3.468032472244
 C   -1.325488267566    0.986430990142   -4.255032472244
 H   -1.427488267566   -1.144569009858   -3.888032472244
 H    0.144511732434   -0.417569009858   -3.525032472244
 H   -1.223488267566   -0.158569009858   -2.426032472244
 H   -0.673488267566    1.790430990142   -3.914032472244
 H   -2.356168267566    1.316160990142   -4.057622472244
 H   -1.120386267566    0.857610990142   -5.328037472244
 C   -1.880488267566    0.530430990142    1.969967527756
 C   -0.088488267566    0.340430990142    0.224967527756
 C   -0.496488267566    0.135430990142    1.538967527756
 C    1.185511732434   -0.036569009858   -0.189032472244
 C    0.389511732434   -0.450569009858    2.440967527756
 C    2.072511732434   -0.610569009858    0.713967527756
 C    1.673511732434   -0.823569009858    2.029967527756
 H   -0.763488267566    0.804430990142   -0.479032472244
 H    1.474511732434    0.095430990142   -1.219032472244
 H   -2.195488267566    1.401430990142    1.392967527756
 H   -1.848488267566    0.839430990142    3.015967527756
 H    0.091511732434   -0.598569009858    3.464967527756
 H    3.064511732434   -0.899569009858    0.391967527756
 H    2.369511732434   -1.258569009858    2.728967527756
 H   -2.627848267566   -0.268519009858    1.855320427756
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-028LEU-133PHE-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-028LEU-133PHE-1-dimer.npy', np.array(charges))