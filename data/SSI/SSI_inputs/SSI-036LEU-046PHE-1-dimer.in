import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    2.145952139682    0.107572307359    1.900725225426
 C    3.225952139682   -0.664427692641    1.155725225426
 H    2.502952139682    0.445572307359    2.870725225426
 H    1.901952139682    0.994572307359    1.328725225426
 H    1.255952139682   -0.506427692641    2.039725225426
 H    3.991952139682    0.033572307359    0.820725225426
 H    3.693467139682   -1.404959692641    1.821335225426
 H    2.807321139682   -1.168802692641    0.272345225426
 C   -0.710047860318   -1.774427692641   -2.084274774574
 C   -1.007047860318    1.497572307359    0.705725225426
 C   -1.925047860318    0.455572307359    0.748725225426
 C    0.008952139682    1.485572307359   -0.242274774574
 C   -1.827047860318   -0.596427692641   -0.163274774574
 C    0.108952139682    0.425572307359   -1.147274774574
 C   -0.808047860318   -0.624427692641   -1.110274774574
 H   -1.086047860318    2.318572307359    1.406725225426
 H   -2.720047860318    0.463572307359    1.483725225426
 H    0.713952139682    2.304572307359   -0.289274774574
 H   -2.549047860318   -1.400427692641   -0.123274774574
 H    0.888952139682    0.440572307359   -1.895274774574
 H   -1.214047860318   -2.643427692641   -1.656274774574
 H    0.339952139682   -2.032427692641   -2.195274774574
 H   -1.151458860318   -1.561258692641   -3.069014774574
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-036LEU-046PHE-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-036LEU-046PHE-1-dimer.npy', np.array(charges))