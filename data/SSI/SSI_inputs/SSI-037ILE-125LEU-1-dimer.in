import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -1.769388948419    0.285584728849   -0.908699640290
 C   -3.108388948419   -0.464415271151   -0.754699640290
 C   -1.709388948419    1.586584728849   -0.127699640290
 H   -0.969388948419   -0.368415271151   -0.567699640290
 H   -1.575388948419    0.513584728849   -1.955699640290
 H   -3.925388948419    0.206584728849   -1.029699640290
 H   -1.686388948419    1.396584728849    0.943300359710
 H   -0.797388948419    2.120584728849   -0.393699640290
 H   -2.567388948419    2.212584728849   -0.376699640290
 H   -3.124099948419   -1.333495271151   -1.428827640290
 H   -3.257736948419   -0.781875271151    0.287853359710
 C    1.661611051581   -0.419415271151    0.531300359710
 C    2.490611051581    0.588584728849    1.326300359710
 C    2.426611051581   -1.589415271151   -0.083699640290
 H    0.877611051581   -0.810415271151    1.183300359710
 H    1.182611051581    0.121584728849   -0.284699640290
 H    3.311611051581    0.943584728849    0.702300359710
 H    3.002611051581   -2.101415271151    0.677300359710
 H    2.905401051581    0.121854728849    2.231903359710
 H    1.877371051581    1.469574728849    1.566701359710
 H    1.701611051581   -2.303545271151   -0.501301640290
 H    3.143571051581   -1.258625271151   -0.849560640290
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-037ILE-125LEU-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-037ILE-125LEU-1-dimer.npy', np.array(charges))