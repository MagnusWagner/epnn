import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -2.397636595862    0.970837430094    0.020733449877
 C   -3.844636595862    1.519837430094   -0.008266550123
 H   -2.328636595862    0.036837430094   -0.532266550123
 H   -1.731636595862    1.696837430094   -0.445266550123
 H   -2.064636595862    0.811837430094    1.044733449877
 H   -3.846636595862    2.466837430094    0.531733449877
 H   -4.537056595862    0.838115430094    0.507303449877
 H   -4.205586595862    1.712153430094   -1.029406550123
 C    0.110363404138   -2.686162569906   -0.041266550123
 C    0.551363404138   -0.455162569906   -1.110266550123
 C    0.666363404138   -1.282162569906   -0.009266550123
 C    1.068363404138    0.830837430094   -1.101266550123
 C    1.322363404138   -0.793162569906    1.113733449877
 C    1.690363404138    1.319837430094    0.018733449877
 C    1.820363404138    0.507837430094    1.128733449877
 H    0.076363404138   -0.820162569906   -2.007266550123
 H    0.974363404138    1.452837430094   -1.981266550123
 H    0.902363404138   -3.384162569906    0.231733449877
 H   -0.191636595862   -2.915162569906   -1.063266550123
 H    1.476363404138   -1.425162569906    1.975733449877
 H    2.108363404138    2.315837430094    0.023733449877
 H    2.370363404138    0.855837430094    1.988733449877
 H   -0.757616595862   -2.839208669906    0.616903449877
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-129VAL-159PHE-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-129VAL-159PHE-1-dimer.npy', np.array(charges))