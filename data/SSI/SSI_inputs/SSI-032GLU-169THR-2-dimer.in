import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C    0.935434136280   -0.039094219322   -1.719939048077
 C    1.390434136280    0.216905780678   -0.300939048077
 O    0.534434136280    0.095905780678    0.602060951923
 O    2.578434136280    0.504905780678   -0.054939048077
 H    0.001434136280    0.493905780678   -1.909939048077
 H    0.713434136280   -1.105094219322   -1.813939048077
 H    1.665344136280    0.202515780678   -2.506609048077
 C   -2.919565863720   -0.899094219322    0.447060951923
 O   -2.150565863720    0.187905780678    0.917060951923
 H   -1.209565863720    0.021905780678    0.685060951923
 H   -3.437565863720   -1.342094219322    1.297060951923
 H   -3.670289863720   -0.528394219322   -0.266379048077
 H   -2.266172863720   -1.672072219322    0.016270951923
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-032GLU-169THR-2-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-032GLU-169THR-2-dimer.npy', np.array(charges))