import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C    1.085407757554   -2.693756569048    1.885511612275
 C    0.665407757554   -1.491756569048    1.009511612275
 O   -0.446592242446   -1.488756569048    0.461511612275
 N    1.531407757554   -0.463756569048    0.867511612275
 H    1.221407757554    0.337243430952    0.309511612275
 H    2.441407757554   -0.486756569048    1.300511612275
 H    1.914407757554   -2.398756569048    2.529511612275
 H    1.455407757554   -3.475756569048    1.222511612275
 H    0.275657757554   -3.110644569048    2.502361612275
 C   -1.722592242446    1.587243430952    0.032511612275
 C   -0.664592242446    1.515243430952   -1.096488387725
 O    0.540407757554    1.474243430952   -0.871488387725
 O   -1.037592242446    1.503243430952   -2.273488387725
 H   -2.386592242446    0.723243430952   -0.040488387725
 H   -2.321592242446    2.480243430952   -0.146488387725
 H   -1.322462242446    1.642958430952    1.055641612275
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-109GLN-161GLU-2-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-109GLN-161GLU-2-dimer.npy', np.array(charges))