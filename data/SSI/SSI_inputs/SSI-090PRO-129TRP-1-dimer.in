import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    2.067596769251   -2.132821575285   -1.923591515137
 C    2.491596769251   -1.270821575285   -3.091591515137
 C    1.765596769251   -3.491821575285   -2.540591515137
 H    1.202596769251   -1.711821575285   -1.408591515137
 H    2.895596769251   -2.231821575285   -1.226591515137
 H    1.604596769251   -0.826821575285   -3.546591515137
 H    3.178596769251   -0.484821575285   -2.778591515137
 H    2.123596769251   -4.264821575285   -1.859591515137
 H    2.962636769251   -1.951941575285   -3.815601515137
 H    2.361886769251   -3.512121575285   -3.464731515137
 H    0.689306769251   -3.643931575285   -2.709281515137
 C   -3.011403230749    1.572178424715   -0.815591515137
 C   -0.818403230749    0.970178424715    0.448408484863
 C   -2.245403230749    1.103178424715    0.360408484863
 C   -0.526403230749    0.406178424715    1.716408484863
 C   -2.750403230749    0.640178424715    1.531408484863
 C    1.550596769251    0.992178424715   -0.003591515137
 C    1.806596769251    0.433178424715    1.261408484863
 C    0.244596769251    1.264178424715   -0.419591515137
 C    0.773596769251    0.135178424715    2.133408484863
 N   -1.728403230749    0.220178424715    2.347408484863
 H    2.382596769251    1.219178424715   -0.657591515137
 H    2.828596769251    0.240178424715    1.559408484863
 H    0.054596769251    1.692178424715   -1.392591515137
 H    0.964596769251   -0.292821575285    3.106408484863
 H   -3.780403230749    0.832178424715   -1.020591515137
 H   -2.337403230749    1.573178424715   -1.671591515137
 H   -3.806403230749    0.580178424715    1.771408484863
 H   -1.869403230749   -0.230821575285    3.250408484863
 H   -3.492873230749    2.559618424715   -0.759371515137
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-090PRO-129TRP-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-090PRO-129TRP-1-dimer.npy', np.array(charges))