import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -0.596150037658    1.202218507240   -1.001857889670
 C   -0.854150037658    2.237218507240   -2.091857889670
 H   -1.542150037658    0.770218507240   -0.669857889670
 H    0.038849962342    0.407218507240   -1.383857889670
 H   -0.101150037658    1.678218507240   -0.155857889670
 H    0.119849962342    2.617218507240   -2.389857889670
 H   -1.464640037658    3.065941507240   -1.703887889670
 H   -1.335400037658    1.810805507240   -2.984367889670
 C    0.307849962342   -2.000781492760    0.977142110330
 C    1.139849962342   -1.437781492760    2.115142110330
 H    0.554849962342   -3.048781492760    0.820142110330
 H   -0.752150037658   -1.932781492760    1.223142110330
 H    0.497849962342   -1.446781492760    0.059142110330
 H    0.973849962342   -2.061781492760    2.994142110330
 H    2.206449962342   -1.459942492760    1.847062110330
 H    0.834749962342   -0.409959492760    2.361102110330
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-173LEU-190VAL-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-173LEU-190VAL-1-dimer.npy', np.array(charges))