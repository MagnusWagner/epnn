import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C    1.962961598977   -0.867444642333   -0.107069507978
 C    0.922961598977   -1.127444642333   -1.164069507978
 O   -0.220038401023   -0.721444642333   -0.956069507978
 O    1.237961598977   -1.729444642333   -2.196069507978
 H    1.516961598977   -0.899444642333    0.889930492022
 H    2.344961598977    0.146555357667   -0.250069507978
 H    2.816609598977   -1.558804642333   -0.164561507978
 C   -1.160038401023    1.773555357667    0.993930492022
 C   -0.819038401023    2.098555357667    2.446930492022
 O   -1.770038401023    0.498555357667    0.890930492022
 H   -1.831038401023    2.536555357667    0.595930492022
 H   -0.242038401023    1.775555357667    0.407930492022
 H   -0.372038401023    3.088555357667    2.453930492022
 H   -1.261038401023    0.011555357667    0.203930492022
 H   -0.102776401023    1.370923357667    2.856220492022
 H   -1.730653401023    2.161751357667    3.059270492022
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-073GLU-119SER-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-073GLU-119SER-1-dimer.npy', np.array(charges))