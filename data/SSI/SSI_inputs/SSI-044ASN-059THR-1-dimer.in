import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -1.784443868786    0.367300505938    0.395643003551
 C   -0.638443868786    1.310300505938    0.110643003551
 O   -0.846443868786    2.490300505938   -0.151356996449
 N    0.580556131214    0.799300505938    0.162643003551
 H    1.341556131214    1.347300505938   -0.216356996449
 H    0.680556131214   -0.204699494062    0.281643003551
 H   -1.693443868786    0.012300505938    1.422643003551
 H   -1.695443868786   -0.489699494062   -0.273356996449
 H   -2.765651868786    0.844630505938    0.256393003551
 C    1.896556131214   -2.480699494062   -0.350356996449
 O    0.572556131214   -2.018699494062   -0.103356996449
 H   -0.028443868786   -2.751699494062   -0.290356996449
 H    2.543556131214   -1.627699494062   -0.558356996449
 H    2.265886131214   -3.018939494062    0.535023003551
 H    1.898716131214   -3.139549494062   -1.231216996449
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-044ASN-059THR-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-044ASN-059THR-1-dimer.npy', np.array(charges))