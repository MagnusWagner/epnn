import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    2.488314999779    1.139194336983   -0.203942163941
 C    1.200314999779    0.370194336983   -0.517942163941
 O    0.154314999779    1.018194336983   -0.765942163941
 O    1.221314999779   -0.881805663017   -0.514942163941
 H    2.214314999779    2.064194336983    0.293057836059
 H    2.981314999779    1.405194336983   -1.141942163941
 H    3.204954999779    0.578964336983    0.414583836059
 C   -2.387685000221   -1.279805663017    1.520057836059
 N   -2.281685000221   -0.296805663017    0.401057836059
 H   -2.377685000221   -0.785805663017   -0.483942163941
 H   -3.038685000221    0.375194336983    0.415057836059
 H   -1.375685000221    0.170194336983    0.336057836059
 H   -3.329685000221   -1.837805663017    1.469057836059
 H   -2.354685000221   -0.760805663017    2.484057836059
 H   -1.544005000221   -1.983595663017    1.466421836059
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-186GLU-189LYS-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-186GLU-189LYS-1-dimer.npy', np.array(charges))