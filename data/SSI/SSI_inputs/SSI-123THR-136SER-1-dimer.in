import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    1.816043318037    0.798546329159   -1.271733361178
 O    0.839043318037    0.910546329159   -0.241733361178
 H    0.402043318037    1.769546329159   -0.362733361178
 H    2.175043318037    1.796546329159   -1.522733361178
 H    2.669873318037    0.205886329159   -0.911547361178
 H    1.361363318037    0.347446329159   -2.166036361178
 C   -1.598956681963   -0.961453670841    1.417266638822
 O   -1.068956681963   -0.843453670841    0.105266638822
 H   -0.287956681963   -0.246453670841    0.130266638822
 H   -2.531956681963   -1.521453670841    1.363266638822
 H   -1.817956681963    0.026546329159    1.824266638822
 H   -0.906374681963   -1.503163670841    2.078236638822
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-123THR-136SER-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-123THR-136SER-1-dimer.npy', np.array(charges))