import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    2.120642511682    0.480766005492    1.173090233760
 C    0.825642511682    1.120766005492    0.750090233760
 O    0.257642511682    0.770766005492   -0.281909766240
 N    0.343642511682    2.062766005492    1.546090233760
 H    2.695642511682    1.183766005492    1.770090233760
 H    2.687642511682    0.248766005492    0.274090233760
 H   -0.510357488318    2.531766005492    1.296090233760
 H    0.848642511682    2.294766005492    2.392090233760
 H    1.969032511682   -0.448403994508    1.742000233760
 C   -1.986357488318   -2.540233994508   -1.061909766240
 O   -1.233357488318   -1.648233994508   -1.878909766240
 H   -1.854357488318   -1.070233994508   -2.339909766240
 H   -2.620357488318   -3.150233994508   -1.707909766240
 H   -1.311127488318   -3.191783994508   -0.487849766240
 H   -2.623837488318   -1.956183994508   -0.381839766240
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-052ASN-143THR-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-052ASN-143THR-1-dimer.npy', np.array(charges))