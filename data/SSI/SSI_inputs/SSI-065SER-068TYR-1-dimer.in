import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C   -0.151670261657    1.388936398776    3.906497291221
 O    0.256329738343    0.812936398776    2.700497291221
 H   -0.127670261657   -0.072063601224    2.634497291221
 H    0.335329738343    0.867936398776    4.732497291221
 H   -1.228670261657    1.291936398776    4.023497291221
 H    0.149749738343    2.446803398776    3.914467291221
 C    1.757329738343    1.943936398776   -1.285502708779
 C   -0.911670261657   -0.335063601224    0.109497291221
 C   -0.855670261657   -1.376063601224   -0.806502708779
 C   -0.085670261657    0.771936398776   -0.096502708779
 C    0.817329738343    0.813936398776   -1.160502708779
 C    0.045329738343   -1.320063601224   -1.874502708779
 C    0.882329738343   -0.226063601224   -2.057502708779
 O   -1.603670261657   -2.501063601224   -0.630502708779
 H   -1.610670261657   -0.369063601224    0.931497291221
 H   -0.158670261657    1.631936398776    0.551497291221
 H    0.098329738343   -2.147063601224   -2.569502708779
 H   -1.443670261657   -3.149063601224   -1.326502708779
 H    1.444329738343    2.770936398776   -0.645502708779
 H    1.724329738343    2.292936398776   -2.318502708779
 H    1.584329738343   -0.206063601224   -2.881502708779
 H    2.784106738343    1.649545398776   -1.022702708779
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-065SER-068TYR-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-065SER-068TYR-1-dimer.npy', np.array(charges))