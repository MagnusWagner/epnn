import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
0 1 
 C    3.796232189541   -1.264641816676   -3.189331955425
 C    0.517232189541   -0.609641816676   -0.457331955425
 C    1.823232189541   -0.445641816676   -0.004331955425
 C    0.288232189541   -0.967641816676   -1.779331955425
 C    2.896232189541   -0.646641816676   -0.879331955425
 C    1.352232189541   -1.168641816676   -2.646331955425
 C    2.667232189541   -1.048641816676   -2.202331955425
 H   -0.311767810459   -0.465641816676    0.217668044575
 H    1.997232189541   -0.149641816676    1.017668044575
 H   -0.723767810459   -1.065641816676   -2.144331955425
 H    3.898232189541   -0.487641816676   -0.519331955425
 H    1.150232189541   -1.427641816676   -3.674331955425
 H    4.053232189541   -0.296641816676   -3.620331955425
 H    3.431232189541   -1.898641816676   -3.998331955425
 H    4.704102189541   -1.727549816676   -2.775231955425
 C   -3.259767810459    1.452358183324   -0.360331955425
 C   -2.462767810459    1.107358183324    0.873668044575
 C   -1.336767810459    1.862358183324    1.202668044575
 C   -2.823767810459    0.024358183324    1.686668044575
 C   -0.558767810459    1.539358183324    2.312668044575
 C   -2.050767810459   -0.310641816676    2.797668044575
 C   -0.914767810459    0.449358183324    3.114668044575
 H   -3.706767810459    0.534358183324   -0.741331955425
 H   -2.575767810459    1.812358183324   -1.127331955425
 H   -1.050767810459    2.698358183324    0.580668044575
 H   -3.694767810459   -0.567641816676    1.446668044575
 H    0.319232189541    2.123358183324    2.551668044575
 H   -2.327767810459   -1.151641816676    3.416668044575
 H   -0.317767810459    0.191358183324    3.975668044575
 H   -4.049579810459    2.199846183324   -0.194621955425
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-021PHE-082PHE-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-021PHE-082PHE-1-dimer.npy', np.array(charges))