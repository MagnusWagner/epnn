import numpy as np

memory 8 GB

set {
scf_type pk
basis aug-cc-pvdz
d_convergence 10
reference rhf
gdma_switch   0
gdma_limit    0
gdma_origin   [ 0.0,  0.0,  0.0 ]
}

molecule test {
-1 1 
 C   -2.150817850004   -0.426713339491   -1.296260988840
 C    0.263182149996    0.144286660509   -0.801260988840
 C   -0.670817850004   -0.444713339491   -1.645260988840
 C    1.647182149996    0.089286660509   -1.078260988840
 C    2.102182149996   -0.556713339491   -2.219260988840
 C   -0.206817850004   -1.085713339491   -2.799260988840
 C    1.183182149996   -1.134713339491   -3.088260988840
 H   -0.095817850004    0.649286660509    0.080739011160
 H    2.365182149996    0.548286660509   -0.408260988840
 H   -2.703817850004   -0.579713339491   -2.225260988840
 H   -2.378817850004    0.568286660509   -0.913260988840
 H    3.162182149996   -0.606713339491   -2.429260988840
 H   -0.920817850004   -1.545713339491   -3.471260988840
 H    1.545182149996   -1.623713339491   -3.985260988840
 H   -2.451607850004   -1.161973339491   -0.535400988840
 C   -0.510817850004   -0.247713339491    3.851739011160
 C   -0.415817850004    0.821286660509    2.797739011160
 O    0.688182149996    1.390286660509    2.703739011160
 O   -1.425817850004    1.076286660509    2.104739011160
 H    0.369182149996   -0.885713339491    3.790739011160
 H   -1.403817850004   -0.847713339491    3.669739011160
 H   -0.552297850004    0.171386660509    4.867939011160
}

e, wfn = energy('pbe', return_wfn=True)
wfn.to_file('SSI-077PHE-205GLU-1-dimer_wfn')
oeprop(wfn, 'MULLIKEN_CHARGES')
gdma(wfn)
dmavals = variable('DMA DISTRIBUTED MULTIPOLES')
charges = np.array(dmavals)
print(charges)
np.save('SSI-077PHE-205GLU-1-dimer.npy', np.array(charges))